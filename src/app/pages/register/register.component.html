<ion-content class="register-container">
  <div class="logo-container">
    <ion-icon name="snow-outline" class="app-logo"></ion-icon>
    <h2>Fridge Manager</h2>
    <p>Create your account to start managing your fridge!</p>
  </div>

  <form [formGroup]="registerForm" (ngSubmit)="register()">
    <ion-list>
      <ion-item>
        <ion-input
          type="email"
          fill="solid"
          label="Email"
          labelPlacement="stacked"
          formControlName="email"
          [errorText]="emailErrorText"
          placeholder="Enter your email"
        ></ion-input>
        <ion-icon
          *ngIf="registerForm.get('email')?.dirty && registerForm.get('email')?.valid"
          name="checkmark-circle-outline"
          color="success"
          slot="end">
        </ion-icon>
        <ion-icon
          *ngIf="registerForm.get('email')?.dirty && registerForm.get('email')?.invalid"
          name="alert-circle-outline"
          color="danger"
          slot="end">
        </ion-icon>
      </ion-item>

      <ion-item>
        <ion-input
          type="text"
          fill="solid"
          label="Username"
          labelPlacement="stacked"
          formControlName="username"
          [errorText]="usernameErrorText"
          placeholder="Choose a username"
        ></ion-input>
        <ion-icon
          *ngIf="registerForm.get('username')?.dirty && registerForm.get('username')?.valid"
          name="checkmark-circle-outline"
          color="success"
          slot="end">
        </ion-icon>
        <ion-icon
          *ngIf="registerForm.get('username')?.dirty && registerForm.get('username')?.invalid"
          name="alert-circle-outline"
          color="danger"
          slot="end">
        </ion-icon>
      </ion-item>

      <ion-item>
        <ion-input
          type="password"
          fill="solid"
          label="Password"
          labelPlacement="stacked"
          formControlName="password"
          [errorText]="passwordErrorText"
          placeholder="Enter a password"
        ></ion-input>
        <ion-icon
          *ngIf="registerForm.get('password')?.dirty && registerForm.get('password')?.valid"
          name="checkmark-circle-outline"
          color="success"
          slot="end">
        </ion-icon>
        <ion-icon
          *ngIf="registerForm.get('password')?.dirty && registerForm.get('password')?.invalid"
          name="alert-circle-outline"
          color="danger"
          slot="end">
        </ion-icon>
      </ion-item>

      <ion-item>
        <ion-input
          type="password"
          fill="solid"
          label="Confirm Password"
          labelPlacement="stacked"
          formControlName="confirmPassword"
          [errorText]="confirmPasswordErrorText"
          placeholder="Confirm your password"
        ></ion-input>
        <ion-icon
          *ngIf="registerForm.get('confirmPassword')?.dirty && registerForm.get('confirmPassword')?.valid"
          name="checkmark-circle-outline"
          color="success"
          slot="end">
        </ion-icon>
        <ion-icon
          *ngIf="registerForm.get('confirmPassword')?.dirty && registerForm.get('confirmPassword')?.invalid"
          name="alert-circle-outline"
          color="danger"
          slot="end">
        </ion-icon>
      </ion-item>

      <!-- Family Selection -->
      <ion-item>
        <ion-checkbox formControlName="isNewFamily">Create new family</ion-checkbox>
      </ion-item>

      <ion-item *ngIf="registerForm.get('isNewFamily')?.value === true">
        <ion-input
          type="text"
          fill="solid"
          formControlName="newFamilyName"
          label="New Family Name"
          labelPlacement="stacked"
          [errorText]="familyErrorText"
          placeholder="Enter family name"
        ></ion-input>
        <ion-icon
          *ngIf="registerForm.get('newFamilyName')?.dirty && registerForm.get('newFamilyName')?.valid"
          name="checkmark-circle-outline"
          color="success"
          slot="end">
        </ion-icon>
        <ion-icon
          *ngIf="registerForm.get('newFamilyName')?.dirty && registerForm.get('newFamilyName')?.invalid"
          name="alert-circle-outline"
          color="danger"
          slot="end">
        </ion-icon>
      </ion-item>
    </ion-list>

    <ion-button expand="block" type="submit" color="primary">Register</ion-button>

    <div class="divider">
      <span>or</span>
    </div>

    <ion-button expand="block" fill="outline" (click)="navigateToLogin()" color="medium">
      <ion-icon name="log-in-outline" slot="start"></ion-icon>
      Back to Login
    </ion-button>
  </form>
</ion-content>

